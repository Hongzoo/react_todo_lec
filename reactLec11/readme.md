# (Todo 만들기) redux

## redux

리덕스는 리액트에서 상태를 더 효율적으로 관리하는 데 사용하는 상태관리 라이브러리이다. 리덕스는 리액트에서 상태관리를 위해 만든 상태 관리 라이브러리이지만, 리액트에 의존하지는 않는다.

[Redux · A Predictable State Container for JS Apps](https://redux.js.org/)
[React Redux · Official React bindings for Redux](https://react-redux.js.org/)

*****

리덕스는 효율적으로 상태 관리를 할 수 있는 라이브러리이다. 스토어에 상태 정보를 가진 객체를 넣어 두고, 액션이 디스패치되었을 때 리듀서 함수를 이용하여 상태를 변화시키고 상태가 변화될 때마다 스토어에 구독된 함수를 실행시키는 것이 주요 역할이다.

- 리덕스는 **상태 관리**의 로직을 컴포넌트 밖에서 처리한다.
- 리덕스를 사용하면 **스토어(store)**라는 객체 내부에 상태를 저장하고, 이 스토어에서 모든 상태 관리가 일어난다.
- 리덕스 스토어에 연결하는 함수를 사용하여 컴포넌트를 스토어에 **구독**시킨다.
- 상태에 어떤 변화를 일으켜야 할 때는 **액션(action)을 스토어에 전달**한다.
- 액션은 객체 형태로 되어 있으며, 상태를 변화시킬 때 이 객체를 참조하여 변화를 일으킨다.
- 액션을 전달하는 과정을 **디스패치(dispatch)**라고 한다.
- 스토어가 액션을 받으면 **리듀서(reducer)**가 전달받은 액션을 기반으로 상태를 어떻게 변경시켜야할지 정한다. 
- 액션을 처리하면 새 상태를 스토어에 저장한다.
- 스토어 안에 있는 상태가 바뀌면 스토어를 구독하고 있는 컴포넌트에 바로 전달한다.

**용어**

- **스토어(store)**: 애플리케이션의 상태 값들을 저장
- **액션(action)**: 상태 변화를 일으킬 때 참조하는 객체
- **디스패치(dispatch)**: 액션을 스토어에 전달하는 것을 의미
- **리듀서(reducer)**: 상태를 변화시키는 로직이 있는 함수
- **구독(subscribe/connect)**: 스토어(상태) 값이 필요한 컴포넌트는 스토어를 구독한다.

**TodoList App**

- App
  + Header
  + TodoList
      - TodoItem
      - TodoItem
      - ...
  + Footer

우리가 만든 TodoList는 App에서 상태를 관리하고 있기 때문에 App 컴포넌트의 state를 업데이트 하면 App 컴포넌트가 리렌더링되고, 리액트 특성상 하위 컴포넌트도 모두 리렌더링 된다.

Header의 input만 업데이트하길 원해도 TodoList와 Footer도 함께 리렌더링된다(이는 최적화 과정에서 TodoList 컴포넌트에서 `shouldComponentUpdate`를 구현하여 방지했다).

TodoList에 사용한 컴포넌트는 개수가 많지 않기 때문에 App에서 상태 관리하고 최적화하는 것이 어렵지 않았지만, 프로젝트가 복잡해지면 상황이 달라진다. 상태 관리 라이브러리를 사용하지 않고 state만 사용한다면 다음 문제가 발생할 수 있다.

- 상태 객체가 너무 복잡하고 크다.
- 최상위 컴포넌트에서 상태 관리를 하는 메서드들이 너무 많이 만들어져 코드가 복잡하다.
- 하위 컴포넌트에 props를 전달하려면 여러 컴포넌트를 거쳐야 한다.

*****

![](http://res.cloudinary.com/dyzj2erac/image/upload/c_limit/wjsojsu3qb6f1322sf5m.jpg)

*****

**Redux 사용**

- Action
    + 액션은 스토어에서 상태 변화를 일으킬 때 참조하는 객체이다.
    + 이 객체는 반드시 type 값을 가지고 있어야 한다
    + 액션 타입은 해당 액션이 어떤 작업을 하는 액션인지 정의하며, 대문자와 밑줄을 조합하여 만든다.
    + 액션에서 type 값은 고정이지만, 나머지 값들은 유동적이다.

- Reducer
    + 상태에 변화를 일으키는 함수, 리듀서
    + 리듀서는 파라미터를 두 개 받는다. 첫 번째 파라미터는 현재 상태고, 두 번째 파라미터는 액션 객체다.
    + 함수 내부에서는 switch 문을 사용하여 action.type에 따라 새로운 상태를 만들어서 반환해야 한다.
    + 리듀서가 초기에 사용할 초기 상태 initialState 값부터 먼저 설정해야 리듀서를 만들 수 있다.

**js-redux-tutorial**
